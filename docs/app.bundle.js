!function(t){function e(e){for(var r,a,s=e[0],u=e[1],c=e[2],f=0,y=[];f<s.length;f++)a=s[f],i[a]&&y.push(i[a][0]),i[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);for(l&&l(e);y.length;)y.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,s=1;s<n.length;s++){var u=n[s];0!==i[u]&&(r=!1)}r&&(o.splice(e--,1),t=a(a.s=n[0]))}return t}var r={},i={0:0},o=[];function a(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var l=u;o.push([1416,1]),n()}({1416:function(t,e,n){"use strict";n.r(e);var r;n(60);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}!function(t){t[t.Initial=0]="Initial",t[t.Input=1]="Input",t[t.CurrentAnimationEnd=2]="CurrentAnimationEnd",t[t.Conditional=3]="Conditional"}(r||(r={}));var a=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,"scene",void 0),o(this,"entity",void 0),o(this,"states",void 0),o(this,"currentState",void 0),o(this,"triggerCancelers",void 0),this.scene=e,this.entity=n,this.states=r,this.currentState=i,this.triggerCancelers=[]}var e,n,a;return e=t,(n=[{key:"create",value:function(){this.doTransition({type:r.Initial,to:this.currentState.id})}},{key:"update",value:function(){this.currentState.onUpdate&&this.currentState.onUpdate(this.entity,this.currentState.data||{})}},{key:"doTransition",value:function(t){this.cancelTransitionTriggers();var e="string"==typeof t.to?t.to:t.to(this.entity);this.currentState=this.states.find(function(t){return t.id===e}),t.onTransition&&t.onTransition(this.entity),this.currentState.onEnter&&this.currentState.onEnter(this.entity,this.currentState.data||{}),this.registerTransitionTriggers()}},{key:"cancelTransitionTriggers",value:function(){this.triggerCancelers.forEach(function(t){return t()}),this.triggerCancelers=[]}},{key:"registerTransitionTriggers",value:function(){var t=this;this.currentState.transitions.forEach(function(e){switch(e.type){case r.Input:t.registerInputTransitionTrigger(e);break;case r.CurrentAnimationEnd:t.registerCurrentAnimationEndTransitionTrigger(e);break;case r.Conditional:t.registerConditionalTransitionTrigger(e)}})}},{key:"registerInputTransitionTrigger",value:function(t){var e=this,n=function(n){n.key===t.key&&e.doTransition(t)};this.scene.input.keyboard.on(t.event,n),this.triggerCancelers.push(function(){return e.scene.input.keyboard.off(t.event,n)})}},{key:"registerCurrentAnimationEndTransitionTrigger",value:function(t){var e=this,n=function(){e.doTransition(t)};this.entity.sprite.anims.currentAnim.on(Phaser.Animations.Events.ANIMATION_COMPLETE,n),this.triggerCancelers.push(function(){return e.entity.sprite.anims.currentAnim.off(Phaser.Animations.Events.ANIMATION_COMPLETE,n)})}},{key:"registerConditionalTransitionTrigger",value:function(t){var e=this,n=function(){t.condition(e.entity)&&e.doTransition(t)};this.scene.events.on(Phaser.Scenes.Events.POST_UPDATE,n),this.triggerCancelers.push(function(){return e.scene.events.off(Phaser.Scenes.Events.POST_UPDATE,n)})}}])&&i(e.prototype,n),a&&i(e,a),t}();function s(t,e){var n=[t.onEnter,e.onEnter].filter(Boolean),r=[t.onUpdate,e.onUpdate].filter(Boolean),i=[t.transitions,e.transitions].filter(Boolean).flat().reduce(function(t,e){return t.find(function(t){return t.to===e.to})||t.push(e),t},[]),a=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){o(t,e,n[e])})}return t}({},t.data,e.data);return{id:t.id||e.id,transitions:i,data:a,onEnter:function(t,e){return n.forEach(function(n){return n(t,e)})},onUpdate:function(t,e){return r.forEach(function(n){return n(t,e)})}}}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,"scene",void 0),c(this,"boundsKey",void 0),c(this,"entity",void 0),c(this,"boundsFrames",void 0),this.scene=e,this.entity=n,this.boundsKey=r}var e,n,r;return e=t,(n=[{key:"create",value:function(){this.boundsFrames=this.scene.cache.json.get(this.boundsKey)}},{key:"update",value:function(){var t=this.entity.sprite.frame.texture.key,e=this.entity.sprite.frame.name,n=this.boundsFrames.find(function(n){return n.key===t&&n.frame===e});if(n){var r=n.bounds,i=r.offset.x,o=r.offset.y;this.entity.sprite.flipX&&(i=this.entity.sprite.width-i-r.size.width),this.entity.sprite.flipY&&(o=this.entity.sprite.height-o-r.size.height),this.entity.body.setSize(r.size.width,r.size.height),this.entity.body.setOffset(i,o)}else this.entity.body.setSize(this.entity.sprite.width,this.entity.sprite.height),this.entity.body.setOffset(0,0);this.entity.body.updateBounds()}}])&&u(e.prototype,n),r&&u(e,r),t}();function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),y(this,"scene",void 0),y(this,"controls",void 0),this.scene=e,this.controls={}}var e,n,r;return e=t,(n=[{key:"create",value:function(){this.controls=this.scene.input.keyboard.addKeys({up:Phaser.Input.Keyboard.KeyCodes.UP,down:Phaser.Input.Keyboard.KeyCodes.DOWN,left:Phaser.Input.Keyboard.KeyCodes.LEFT,right:Phaser.Input.Keyboard.KeyCodes.RIGHT})}},{key:"getControls",value:function(){return this.controls}}])&&f(e.prototype,n),r&&f(e,r),t}();function p(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=function(){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),v(this,"scene",void 0),v(this,"entity",void 0),v(this,"animationsKey",void 0),v(this,"hitboxFrames",void 0),v(this,"rectanglePool",void 0),v(this,"activeRectangles",void 0),v(this,"debugRectangles",void 0),v(this,"debug",void 0),v(this,"debugPointerPosition",void 0),v(this,"debugColor",void 0),this.scene=e,this.entity=n,this.animationsKey=r,this.rectanglePool=[],this.activeRectangles=[],this.debug=i,this.debugColor=65280,this.debugRectangles=[]}var e,n,r;return e=t,(n=[{key:"create",value:function(){var t=this;this.hitboxFrames=this.scene.cache.json.get(this.animationsKey).frames,this.debugRectangles=[],this.debugPointerPosition={x:0,y:0},this.debug&&this.scene.input.on("pointermove",function(e){t.debugPointerPosition=e.position})}},{key:"update",value:function(){var t=this;this.disableHitboxes();var e=this.entity.sprite.frame.texture.key,n=this.entity.sprite.frame.name,r=this.hitboxFrames.find(function(t){return t.key===e&&t.frame===n});r&&r.hitboxes&&r.hitboxes.forEach(function(e){if("rectangle"!==e.type)throw"unsupported hitbox type";t.setRectangleHitbox(e)}),this.debug&&this.renderDebugHitboxes()}},{key:"renderDebugHitboxes",value:function(){var t=this,e=new Phaser.Geom.Point(this.debugPointerPosition.x,this.debugPointerPosition.y);this.activeRectangles.forEach(function(n,r){Phaser.Geom.Rectangle.ContainsPoint(n,e)?t.debugColor=16711680:t.debugColor=65280;var i=t.debugRectangles[r];i.visible=!0,i.fillColor=t.debugColor,i.setOrigin(0,0),i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height})}},{key:"disableHitboxes",value:function(){this.rectanglePool=[].concat(p(this.rectanglePool),p(this.activeRectangles)),this.activeRectangles=[],this.debugRectangles.forEach(function(t){return t.visible=!1})}},{key:"getAvailableRectangle",value:function(){var t=this.rectanglePool.pop();return null==t&&(t=new Phaser.Geom.Rectangle(0,0,0,0),this.debug&&this.debugRectangles.push(this.scene.add.rectangle(0,0,0,0,this.debugColor,.5))),this.activeRectangles.push(t),t}},{key:"setRectangleHitbox",value:function(t){var e=this.getAvailableRectangle(),n=this.entity.sprite.scaleX,r=this.entity.sprite.scaleY,i=this.entity.sprite.flipX?-1*t.x:t.x,o=this.entity.sprite.flipY?-1*t.y:t.y,a=n*t.width,s=r*t.height,u=this.entity.sprite.x+i*n-a*this.entity.sprite.originX,c=this.entity.sprite.y+o*r-s*this.entity.sprite.originY;e.x=u,e.y=c,e.width=a,e.height=s}}])&&d(e.prototype,n),r&&d(e,r),t}();function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),m(this,"scene",void 0),m(this,"x",void 0),m(this,"y",void 0),m(this,"key",void 0),m(this,"sprite",void 0),this.scene=e,this.x=n,this.y=r,this.key=i}var e,n,r;return e=t,(n=[{key:"create",value:function(){this.sprite=this.scene.physics.add.sprite(this.x,this.y,this.key)}},{key:"getSprite",value:function(){return this.sprite}},{key:"getBody",value:function(){return this.sprite.body}}])&&g(e.prototype,n),r&&g(e,r),t}(),E={maxVelocity:350,horizontalAcceleration:800,horizontalDeceleration:2e3,slideVelocityThreshold:250,slideDeceleration:400,jumpVelocity:-500,aerialMaxHorizontalVelocity:250,aerialHorizontalAcceleration:300,aerialHorizontalFrictionAcceleration:150},P={transitions:[{type:r.Conditional,condition:function(t){return t.body.velocity.y>5},to:function(t){return t.body.velocity.y=100,t.body.velocity.x>0?"adventurer-fall-right":t.body.velocity.x<0?"adventurer-fall-left":"adventurer-fall"}}]};var O=s(P,{onEnter:function(t){!function(t){t.body.acceleration.x=t.body.velocity.x<0?E.horizontalDeceleration:-E.horizontalDeceleration}(t)},onUpdate:function(t){!function(t){Phaser.Math.Within(t.body.velocity.x,0,100)&&(t.body.acceleration.x=0,t.body.velocity.x=0)}(t)}}),j=s(O,{id:"adventurer-stand",onEnter:function(t){t.sprite.anims.play("adventurer-stand")},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowRight",to:"adventurer-run-right"},{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowLeft",to:"adventurer-run-left"},{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowDown",to:"adventurer-crouch"},{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowUp",to:"adventurer-jump-prep"}]}),S=s(O,{id:"adventurer-crouch",onEnter:function(t){t.sprite.anims.play("adventurer-crouch")},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_UP,key:"ArrowDown",to:function(t){return t.controls.left.isDown?"adventurer-run-left":t.controls.right.isDown?"adventurer-run-right":"adventurer-stand"}}]}),x=s(P,{onEnter:function(t){t.sprite.flipX=!1,t.sprite.anims.play("adventurer-run")},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowDown",to:function(t){return Math.abs(t.body.velocity.x)<E.slideVelocityThreshold?"adventurer-crouch":"adventurer-slide"}},{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowUp",to:"adventurer-jump-prep"}]});function k(t,e){"left"===e?t.body.acceleration.x=-E.horizontalAcceleration:"right"===e&&(t.body.acceleration.x=E.horizontalAcceleration),function(t){Phaser.Math.Within(t.body.velocity.x,0,5)||(t.body.velocity.x+=.5*t.body.velocity.x*-1)}(t)}var _=s(x,{id:"adventurer-run-right",onEnter:function(t){t.sprite.flipX=!1,t.sprite.anims.play("adventurer-run"),k(t,"right")},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_UP,key:"ArrowRight",to:"adventurer-stand"},{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowLeft",to:"adventurer-run-left"}]}),A=s(x,{id:"adventurer-run-left",onEnter:function(t){t.sprite.flipX=!0,t.sprite.anims.play("adventurer-run"),k(t,"left")},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_UP,key:"ArrowLeft",to:"adventurer-stand"},{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowRight",to:"adventurer-run-right"}]}),T=s(P,{id:"adventurer-slide",onEnter:function(t){t.sprite.anims.play("adventurer-slide"),t.body.velocity.x>0?t.body.acceleration.x=-1*E.slideDeceleration:t.body.acceleration.x=E.slideDeceleration},transitions:[{type:r.CurrentAnimationEnd,to:function(t){return t.controls.left.isDown?"adventurer-run-left":t.controls.right.isDown?"adventurer-run-right":t.controls.down.isDown?"adventurer-crouch":"adventurer-stand"}},{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowUp",to:"adventurer-jump-prep"}]}),I={id:"adventurer-jump-prep",onEnter:function(t){t.body.acceleration.x=0,t.sprite.anims.play("adventurer-jump-prep")},transitions:[{type:r.CurrentAnimationEnd,to:function(t){return t.controls.right.isDown?"adventurer-jump-right":t.controls.left.isDown?"adventurer-jump-left":t.body.velocity.x>0?"adventurer-jump-right":t.body.velocity.x<0?"adventurer-jump-left":"adventurer-jump"},onTransition:function(t){t.body.velocity.y=E.jumpVelocity}}]};var C={onUpdate:function(t,e){t.controls.left.isDown||t.controls.right.isDown?function(t,e){t.controls.left.isDown&&t.body.velocity.x>e?t.body.acceleration.x=-1*E.aerialHorizontalAcceleration:t.controls.right.isDown&&t.body.velocity.x<e&&(t.body.acceleration.x=E.aerialHorizontalAcceleration)}(t,e.targetAerialHorizontalVelocity):function(t){t.body.velocity.x>0?t.body.acceleration.x=-1*E.aerialHorizontalFrictionAcceleration:t.body.velocity.x<0?t.body.acceleration.x=E.aerialHorizontalFrictionAcceleration:t.body.acceleration.x=0}(t),Phaser.Math.Within(e.targetAerialHorizontalVelocity,t.body.velocity.x,5)&&(t.body.acceleration.x=0,t.body.velocity.x=e.targetAerialHorizontalVelocity)}},K=s(C,{onEnter:function(t){t.sprite.anims.play("adventurer-jump-rise")}}),D=s(K,{id:"adventurer-jump",data:{targetAerialHorizontalVelocity:0},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowLeft",to:"adventurer-jump-left"},{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowRight",to:"adventurer-jump-right"},{type:r.Conditional,condition:function(t){return t.body.velocity.y>1},to:"adventurer-fall"}]}),M=s(K,{id:"adventurer-jump-left",data:{targetAerialHorizontalVelocity:-1*E.aerialMaxHorizontalVelocity},onEnter:function(t){t.sprite.flipX=!0},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowRight",to:"adventurer-jump-right"},{type:r.Conditional,condition:function(t){return t.body.velocity.y>0},to:"adventurer-fall-left"}]}),Y=s(K,{id:"adventurer-jump-right",data:{targetAerialHorizontalVelocity:E.aerialMaxHorizontalVelocity},onEnter:function(t){t.sprite.flipX=!1},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowLeft",to:"adventurer-jump-left"},{type:r.Conditional,condition:function(t){return t.body.velocity.y>0},to:"adventurer-fall-right"}]}),N=s(C,{onEnter:function(t){t.sprite.anims.play("adventurer-fall")},transitions:[{type:r.Conditional,condition:function(t){return Phaser.Math.Within(t.body.velocity.y,0,5)},to:function(t){return t.controls.down.isDown?Math.abs(t.body.velocity.x)<E.slideVelocityThreshold?"adventurer-crouch":"adventurer-slide":t.controls.left.isDown?"adventurer-run-left":t.controls.right.isDown?"adventurer-run-right":"adventurer-stand"}}]}),R=[j,S,_,A,T,I,D,M,Y,s(N,{id:"adventurer-fall",data:{horizontalMaxVelocity:0},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowLeft",to:"adventurer-fall-left"},{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowRight",to:"adventurer-fall-right"}]}),s(N,{id:"adventurer-fall-left",data:{targetAerialHorizontalVelocity:-1*E.aerialMaxHorizontalVelocity},onEnter:function(t){t.sprite.flipX=!0},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowRight",to:"adventurer-fall-right"}]}),s(N,{id:"adventurer-fall-right",data:{targetAerialHorizontalVelocity:E.aerialMaxHorizontalVelocity},onEnter:function(t,e){t.sprite.flipX=!1},transitions:[{type:r.Input,event:Phaser.Input.Keyboard.Events.ANY_KEY_DOWN,key:"ArrowLeft",to:"adventurer-fall-left"}]})];function z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function H(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var W=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),H(this,"sprite",void 0),H(this,"body",void 0),H(this,"controls",void 0),H(this,"phiniteState",void 0),H(this,"hurtboxes",void 0),H(this,"boundable",void 0),H(this,"interactable",void 0),H(this,"interactionCircle",void 0)}var e,n,r;return e=t,(n=[{key:"create",value:function(t){var e=this;t.events.on(Phaser.Scenes.Events.POST_UPDATE,function(){return e.update()});var n=new w(t,900,100,"adventurer-core");n.create(),this.sprite=n.getSprite(),this.sprite.setScale(2),this.body=n.getBody(),this.body.maxVelocity.x=E.maxVelocity,this.body.setSize(25,32),this.body.setOffset(12,5);var r=new h(t);r.create(),this.controls=r.getControls(),this.phiniteState=new a(t,this,R,R.find(function(t){return"adventurer-stand"===t.id})),this.phiniteState.create(),this.hurtboxes=new b(t,this,"adventurer-hitboxes"),this.hurtboxes.create(),this.boundable=new l(t,this,"adventurer-bounds"),this.boundable.create()}},{key:"update",value:function(){this.phiniteState.update(),this.hurtboxes.update(),this.boundable.update()}}])&&z(e.prototype,n),r&&z(e,r),t}();function V(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function L(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var X=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),L(this,"entityMap",void 0),L(this,"systemsMap",void 0),this.entityMap={},this.systemsMap={}}var e,n,r;return e=t,(n=[{key:"registerSystem",value:function(t,e){var n=this;(Array.isArray(t)?t:[t]).forEach(function(t){n.systemsMap[t]=n.systemsMap[t]||[],n.systemsMap[t].push(e)})}},{key:"registerEntity",value:function(t,e,n){var r=this;(Array.isArray(t)?t:[t]).forEach(function(t){r.entityMap[t]=r.entityMap[t]||[],r.entityMap[t].push(e),r.systemsMap[t]=r.systemsMap[t]||[],r.systemsMap[t].forEach(function(t){return t.registerEntity(e,n||{})})})}},{key:"getEntities",value:function(t){return this.entityMap[t]}},{key:"update",value:function(){var t=this;Object.entries(this.systemsMap).forEach(function(e){var n=V(e,2);n[0];n[1].forEach(function(e){return e.update(t)})})}}])&&U(e.prototype,n),r&&U(e,r),t}();function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function B(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var G=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),B(this,"tag1",void 0),B(this,"tag2",void 0),B(this,"tag1s",void 0),B(this,"tag2s",void 0),this.tag1=e,this.tag2=n,this.tag1s=[],this.tag2s=[]}var e,n,r;return e=t,(n=[{key:"registerEntity",value:function(t,e){}},{key:"update",value:function(t){this.tag1s=t.getEntities(this.tag1)||[],this.tag2s=t.getEntities(this.tag2)||[]}}])&&F(e.prototype,n),r&&F(e,r),t}();function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Q(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Z(t,e,n){return(Z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function $(t){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tt(t,e){return(tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var et,nt,rt,it=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Q(this,$(e).call(this,e.SystemTags.interactor,e.SystemTags.sign))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tt(t,e)}(e,G),n=e,(r=[{key:"registerEntity",value:function(t){}},{key:"update",value:function(t){Z($(e.prototype),"update",this).call(this,t);var n=this.tag1s,r=this.tag2s;n.forEach(function(t){r.forEach(function(e){var n=t.interactionCircle,r=e.interactionCircle;Phaser.Geom.Intersects.CircleToCircle(n,r)?e.showIndicator():e.hideIndicator()})})}}])&&q(n.prototype,r),i&&q(n,i),e}();function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ct(t,e){return(ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}rt={interactor:"sign-interactor",sign:"sign-interactive"},(nt="SystemTags")in(et=it)?Object.defineProperty(et,nt,{value:rt,enumerable:!0,configurable:!0,writable:!0}):et[nt]=rt;var ft=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(i=st(e).call(this,e.SystemTags.renderable,""))||"object"!==ot(i)&&"function"!=typeof i?ut(r):i,lt(ut(n),"scene",void 0),n.scene=t,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ct(t,e)}(e,G),n=e,(r=[{key:"registerEntity",value:function(t,e){console.log("renderable");var n=e.x,r=e.y,i=e.texture,o=e.frame,a=this.scene.add.sprite(n,r,i,o);e.scale&&a.setScale(e.scale),t.sprite=a}}])&&at(n.prototype,r),i&&at(n,i),e}();function yt(t){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dt(t,e,n){return(dt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function vt(t){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bt(t,e){return(bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}lt(ft,"SystemTags",{renderable:"renderable"});var mt=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(i=vt(e).call(this,e.SystemTags.interactable,""))||"object"!==yt(i)&&"function"!=typeof i?pt(r):i,gt(pt(n),"scene",void 0),n.scene=t,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bt(t,e)}(e,G),n=e,(r=[{key:"registerEntity",value:function(t,e){console.log("regsitered");var n=new Phaser.Geom.Circle(e.x,e.y,e.radius);t.interactionCircle=n}},{key:"update",value:function(t){dt(vt(e.prototype),"update",this).call(this,t),this.tag1s.forEach(function(t){t.interactionCircle.setPosition(t.sprite.x,t.sprite.y)})}}])&&ht(n.prototype,r),i&&ht(n,i),e}();function wt(t){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ot(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jt(t,e){return(jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function St(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}gt(mt,"SystemTags",{interactable:"interactable"});var xt=function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(i=Pt(e).call(this,e.SystemTags.hasIndicator,""))||"object"!==wt(i)&&"function"!=typeof i?Ot(r):i,St(Ot(n),"scene",void 0),n.scene=t,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jt(t,e)}(e,G),n=e,(r=[{key:"registerEntity",value:function(t,e){var n=e.targetX,r=e.targetY,i=this.scene.add.sprite(n,r,"indicator-down");i.setScale(2),t.showIndicator=function(){i.visible=!0,i.active=!0,i.anims.play("indicator-down",!0)},t.hideIndicator=function(){i.visible=!1,i.active=!1,i.anims.stop()}}}])&&Et(n.prototype,r),i&&Et(n,i),e}();function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function At(t){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function It(t,e){return(It=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ct(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}St(xt,"SystemTags",{hasIndicator:"hasIndicator"});var Kt={width:800,height:450,scene:function(t){function e(t){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(i=At(e).call(this,t))||"object"!==kt(i)&&"function"!=typeof i?Tt(r):i,Ct(Tt(n),"adventurer",void 0),Ct(Tt(n),"tagManager",void 0),n.adventurer=new W,n.tagManager=new X,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&It(t,e)}(e,Phaser.Scene),n=e,(r=[{key:"preload",value:function(){this.load.spritesheet("adventurer-core","/assets/sprites/adventurer/adventurer-core.png",{frameWidth:50,frameHeight:37}),this.load.spritesheet("adventurer-bow","/assets/sprites/adventurer/adventurer-bow.png",{frameWidth:50,frameHeight:37}),this.load.animation("adventurer-animations","/assets/animations/adventurer.json"),this.load.json("adventurer-hitboxes","/assets/hitboxes/adventurer.json"),this.load.json("adventurer-bounds","/assets/bounds/adventurer.json"),this.load.spritesheet("indicator-down","/assets/sprites/indicators/indicator-down.png",{frameWidth:16,frameHeight:16}),this.load.animation("indicator-animations","/assets/animations/indicators.json"),this.load.spritesheet("fantasy-platformer-core-spritesheet","/assets/tilesets/fantasy-platformer-core.png",{frameWidth:16,frameHeight:16}),this.load.image("fantasy-platformer-core","/assets/tilesets/fantasy-platformer-core.png"),this.load.tilemapTiledJSON("starting-area","/assets/tilemaps/starting-area.json")}},{key:"create",value:function(){var t=this.make.tilemap({key:"starting-area"}),e=t.addTilesetImage("fantasy-platformer-core","fantasy-platformer-core"),n=t.createStaticLayer("ground",e,0,0),r=t.createStaticLayer("background-base",e,0,0),i=t.createStaticLayer("background-details",e,0,0);this.adventurer.create(this);var o=t.createStaticLayer("foreground",e,0,0),a=t.getObjectLayer("signs").objects[0],s={};this.tagManager.registerSystem([it.SystemTags.interactor,it.SystemTags.sign],new it),this.tagManager.registerSystem(ft.SystemTags.renderable,new ft(this)),this.tagManager.registerSystem(mt.SystemTags.interactable,new mt(this)),this.tagManager.registerSystem(xt.SystemTags.hasIndicator,new xt(this)),this.tagManager.registerEntity(ft.SystemTags.renderable,s,{x:2*a.x,y:2*a.y-t.tileHeight,texture:"fantasy-platformer-core-spritesheet",frame:1128,scale:2}),this.tagManager.registerEntity(mt.SystemTags.interactable,s,{x:s.sprite.x,y:s.sprite.y,radius:30}),this.tagManager.registerEntity(mt.SystemTags.interactable,this.adventurer,{x:this.adventurer.sprite.x,y:this.adventurer.sprite.y,radius:30}),this.tagManager.registerEntity(it.SystemTags.interactor,this.adventurer),this.tagManager.registerEntity(it.SystemTags.sign,s),this.tagManager.registerEntity(xt.SystemTags.hasIndicator,s,{targetX:s.sprite.x,targetY:s.sprite.y-s.sprite.displayHeight-5}),n.setScale(2),r.setScale(2),i.setScale(2),o.setScale(2),n.setCollisionByProperty({collides:!0}),this.physics.add.collider(this.adventurer.sprite,n),this.cameras.main.setBounds(0,0,t.width*e.tileWidth*2,t.height*e.tileHeight*2),this.cameras.main.startFollow(this.adventurer.sprite,!0)}},{key:"update",value:function(){this.tagManager.update()}}])&&_t(n.prototype,r),i&&_t(n,i),e}(),pixelArt:!0,physics:{default:"arcade",arcade:{gravity:{y:1100}}}};new Phaser.Game(Kt)}});