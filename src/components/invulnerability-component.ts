import { SpriteComponent } from "./sprite-component";

export class InvulnerabilityComponent implements Phecs.Component {
  public isInvulnerable: boolean;

  private scene: Phaser.Scene;
  private sprite: Phaser.GameObjects.Sprite;

  constructor(scene: Phaser.Scene, data: Phecs.EntityData, entity: Phecs.Entity) {
    this.scene = scene;
    this.isInvulnerable = false;
    this.sprite = entity.getComponent(SpriteComponent).sprite;
  }

  makeInvulnerable() {
    this.isInvulnerable = true;
    this.sprite.alpha = 0.5;

    const timerEvent = this.scene.time.delayedCall(500, () => {
      this.sprite.alpha = 1;
      this.isInvulnerable = false;
      timerEvent.destroy();
    });
  }

  destroy() {
    delete this.isInvulnerable;
  }
}
